# Run all tool setups (formatters/linters/CLIs youâ€™ll also use from the shell)
[tasks.setup]
description = "Install/upgrade global CLIs by language/tool; then reshim"
depends = [
  "setup.node",
  "setup.python",
  "setup.lua",
  "setup.toml",
  "setup.yaml",
  "setup.sql",
  "setup.rust",
  "setup.go",
]
run = ["mise reshim"]

# -------------------------
# Node (global CLIs)
# -------------------------
[tasks.setup.node]
description = "Node globals via npm; enable Corepack for repo-declared managers"
run = [
  "corepack enable || true",
  "npm i -g npm",
  "npm i -g pyright prettier markdownlint-cli2",
]

# -------------------------
# Python (global CLIs via pipx)
# -------------------------
[tasks.setup.python]
description = "Python formatters/linters via pipx (uses mise python)"
run = [
  "pipx ensurepath || true",
  "pipx install --python $(which python3) ruff || pipx upgrade ruff",
  "pipx install --python $(which python3) debugpy || pipx upgrade debugpy",
]

# Rebuild pipx shims after changing Python minor/patch
[tasks.python.rebuild]
description = "Reinstall pipx apps against current mise Python"
run = ["pipx reinstall-all --python $(mise which python)", "mise reshim"]

# -------------------------
# Lua (via cargo)
# -------------------------
[tasks.setup.lua]
description = "Lua tooling"
run = ["cargo install stylua || true"]

# -------------------------
# TOML (via cargo)
# -------------------------
[tasks.setup.toml]
description = "TOML tooling"
run = ["cargo install taplo-cli || true"]

# -------------------------
# YAML (style linter)
# -------------------------
[tasks.setup.yaml]
description = "YAML style checking"
run = [
  "pipx install --python $(which python3) yamllint || pipx upgrade yamllint",
]

# -------------------------
# SQL (style/standards)
# -------------------------
[tasks.setup.sql]
description = "SQL linting/formatting (configure dialects in project .sqlfluff)"
run = [
  "pipx install --python $(which python3) sqlfluff || pipx upgrade sqlfluff",
]

# -------------------------
# Rust (ensure analyzer available for rustaceanvim)
# -------------------------
[tasks.setup.rust]
description = "Rust analyzer availability"
run = [
  "rustup default stable || true",
  "rustup component add rust-analyzer || true",
]

# -------------------------
# Go (extras optional; LazyVim go extra covers basics)
# -------------------------
[tasks.setup.go]
description = "Go tooling (optional extras)"
run = [
  # "go install mvdan.cc/sh/v3/cmd/shfmt@latest",
  # "go install github.com/segmentio/golines@latest",
]
